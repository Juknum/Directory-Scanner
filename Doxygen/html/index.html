<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Arborescence_Displayer: Projet de LP25</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Arborescence_Displayer
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">System to write the arborescence of a specified directory.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Projet de LP25 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> </p>
<h1><a class="anchor" id="autotoc_md1"></a>
Enoncé de Frédéric Lassabe</h1>
<p>L'évaluation de la partie programmation en langage C de LP25 se base sur un projet à réaliser en groupes de 4 étudiants. Ce projet doit être réalisé en langage C.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Descriptif global du projet</h2>
<p>Ce projet a pour but d'écrire un programme qui va scanner récursivement un répertoire, et en extraire l'arborescence complète de ce répertoire. Cette arborescence devra être stockée dans un premier temps dans la mémoire de l'ordinateur au cours de l'exécution du programme, puis ce contenu, une fois trié, devra être écrit dans un fichier.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Description détaillées des fonctionnalités</h2>
<p>Les fonctionnalités du programme à développer sont détaillées dans les paragraphes ci-dessous. Le cas échéant, le paragraphe vous donne le paramètre par défaut utilisé par cette fonctionnalité, en l'absence de toute option passée au programme.</p>
<h3><a class="anchor" id="autotoc_md4"></a>
Scan du répertoire</h3>
<p>Par défaut : scanne <code>.</code></p>
<p>En partant du répertoire indiqué, le programme va créer la liste des fichiers et répertoires contenus (à l'exception de <code>.</code> et <code>..</code>). Attention, il ne faut pas suivre les liens symboliques (il y a risque de boucle infinie). Puis, le programme rentre successivement dans les éventuels répertoires contenus par le répertoire cible et procède au même traitement, jusqu'à atteindre l'extrémité de l'arborescence du dossier passé en paramètre.</p>
<p>Vous traiterez les types de fichiers de la manière suivante :</p>
<ul>
<li>fichier : nom, taille, date de modification, somme MD5</li>
<li>dossier : nom, date de modification, puis traiter son contenu</li>
<li>lien symbolique : nom, fichier pointé, date de modification</li>
<li>autre : nom, date de modification</li>
</ul>
<p>Évidemment, il faut tester que le paramètre donnant la cible du scan est bien un dossier valide.</p>
<h3><a class="anchor" id="autotoc_md5"></a>
Stockage en mémoire</h3>
<p>Le stockage en mémoire est fait sous forme arborescente. L'idée est de partir d'une structure composée de dossiers et de fichiers, et de chaîner ces éléments.</p>
<p>Deux structures définiront le contenu en mémoire, sous forme de listes chaînées :</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;linux/limits.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;openssl/md5.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> {<a class="code" href="structures_8h.html#a07fb55fb8ca681eee25e1f632b6701ada9d09f58160b1161920aad19080f568cc">DIRECTORY</a>, <a class="code" href="structures_8h.html#a07fb55fb8ca681eee25e1f632b6701ada00512007115c06f83e278302d7c70590">REGULAR_FILE</a>, <a class="code" href="structures_8h.html#a07fb55fb8ca681eee25e1f632b6701adaabd2ef38f6c18626db708c01cc587429">OTHER_TYPE</a>} <a class="code" href="structures_8h.html#a07fb55fb8ca681eee25e1f632b6701ad">e_type</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__file.html">_file</a> {</div>
<div class="line">    <a class="code" href="structures_8h.html#a07fb55fb8ca681eee25e1f632b6701ad">e_type</a> <a class="code" href="struct__file.html#a7e8129d8058dec78ca8d0b050de2d564">file_type</a>;</div>
<div class="line">    <span class="keywordtype">char</span> <a class="code" href="struct__file.html#ad9c747aeade1f77b30a4393a4be2a1be">name</a>[NAME_MAX+1];</div>
<div class="line">    time_t <a class="code" href="struct__file.html#abe5fcec02f652fd7d3e2c4e9f6791af2">mod_time</a>;</div>
<div class="line">    uint64_t <a class="code" href="struct__file.html#af564d0d073559935815f33b08f7fbd51">file_size</a>;</div>
<div class="line">    u_char <a class="code" href="struct__file.html#a52a3d7d9468ddb2350dfb8f9c61e2607">md5sum</a>[MD5_DIGEST_LENGTH];</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="struct__file.html">_file</a> *<a class="code" href="struct__file.html#acad76db375ab79fd517b442cb7195cd8">next_file</a>;</div>
<div class="line">} <a class="code" href="structures_8h.html#ae959bb43b3e29fdc649ae621a6607247">s_file</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__directory.html">_directory</a> {</div>
<div class="line">    <span class="keywordtype">char</span> <a class="code" href="struct__directory.html#ad9c747aeade1f77b30a4393a4be2a1be">name</a>[NAME_MAX+1];</div>
<div class="line">    time_t <a class="code" href="struct__directory.html#abe5fcec02f652fd7d3e2c4e9f6791af2">mod_time</a>;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="struct__directory.html">_directory</a> *<a class="code" href="struct__directory.html#aac6c7e733d79f8a3fe6cec26bf512fa1">subdirs</a>;</div>
<div class="line">    <a class="code" href="struct__file.html">s_file</a> *<a class="code" href="struct__directory.html#a705f00320d1816155d0b9901c88e884a">files</a>;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="struct__directory.html">_directory</a> *<a class="code" href="struct__directory.html#a1bc424155753091e188c10ba24f1cd49">next_dir</a>;</div>
<div class="line">} <a class="code" href="structures_8h.html#a01f65533173671ccead98bc86ff8f004">s_directory</a>;</div>
<div class="ttc" id="astruct__directory_html"><div class="ttname"><a href="struct__directory.html">_directory</a></div><div class="ttdoc">Structur to stock the content of a directory.</div><div class="ttdef"><b>Definition:</b> structures.h:59</div></div>
<div class="ttc" id="astruct__directory_html_a1bc424155753091e188c10ba24f1cd49"><div class="ttname"><a href="struct__directory.html#a1bc424155753091e188c10ba24f1cd49">_directory::next_dir</a></div><div class="ttdeci">struct _directory * next_dir</div><div class="ttdoc">A pointer on the next directory.</div><div class="ttdef"><b>Definition:</b> structures.h:64</div></div>
<div class="ttc" id="astruct__directory_html_a705f00320d1816155d0b9901c88e884a"><div class="ttname"><a href="struct__directory.html#a705f00320d1816155d0b9901c88e884a">_directory::files</a></div><div class="ttdeci">s_file * files</div><div class="ttdoc">A pointer on an element of a linked list of s_file.</div><div class="ttdef"><b>Definition:</b> structures.h:63</div></div>
<div class="ttc" id="astruct__directory_html_aac6c7e733d79f8a3fe6cec26bf512fa1"><div class="ttname"><a href="struct__directory.html#aac6c7e733d79f8a3fe6cec26bf512fa1">_directory::subdirs</a></div><div class="ttdeci">struct _directory * subdirs</div><div class="ttdoc">A pointer on an element of a linked list of s_directory.</div><div class="ttdef"><b>Definition:</b> structures.h:62</div></div>
<div class="ttc" id="astruct__directory_html_abe5fcec02f652fd7d3e2c4e9f6791af2"><div class="ttname"><a href="struct__directory.html#abe5fcec02f652fd7d3e2c4e9f6791af2">_directory::mod_time</a></div><div class="ttdeci">time_t mod_time</div><div class="ttdoc">The last date of modification.</div><div class="ttdef"><b>Definition:</b> structures.h:61</div></div>
<div class="ttc" id="astruct__directory_html_ad9c747aeade1f77b30a4393a4be2a1be"><div class="ttname"><a href="struct__directory.html#ad9c747aeade1f77b30a4393a4be2a1be">_directory::name</a></div><div class="ttdeci">char name[NAME_MAX+1]</div><div class="ttdoc">The basename of the directory.</div><div class="ttdef"><b>Definition:</b> structures.h:60</div></div>
<div class="ttc" id="astruct__file_html"><div class="ttname"><a href="struct__file.html">_file</a></div><div class="ttdoc">Structure to stock the content of a file.</div><div class="ttdef"><b>Definition:</b> structures.h:45</div></div>
<div class="ttc" id="astruct__file_html_a52a3d7d9468ddb2350dfb8f9c61e2607"><div class="ttname"><a href="struct__file.html#a52a3d7d9468ddb2350dfb8f9c61e2607">_file::md5sum</a></div><div class="ttdeci">u_char md5sum[MD5_DIGEST_LENGTH]</div><div class="ttdoc">The md5sum of the file if it is not a directory.</div><div class="ttdef"><b>Definition:</b> structures.h:50</div></div>
<div class="ttc" id="astruct__file_html_a7e8129d8058dec78ca8d0b050de2d564"><div class="ttname"><a href="struct__file.html#a7e8129d8058dec78ca8d0b050de2d564">_file::file_type</a></div><div class="ttdeci">e_type file_type</div><div class="ttdoc">Type of file.</div><div class="ttdef"><b>Definition:</b> structures.h:46</div></div>
<div class="ttc" id="astruct__file_html_abe5fcec02f652fd7d3e2c4e9f6791af2"><div class="ttname"><a href="struct__file.html#abe5fcec02f652fd7d3e2c4e9f6791af2">_file::mod_time</a></div><div class="ttdeci">time_t mod_time</div><div class="ttdoc">The last date of modification.</div><div class="ttdef"><b>Definition:</b> structures.h:48</div></div>
<div class="ttc" id="astruct__file_html_acad76db375ab79fd517b442cb7195cd8"><div class="ttname"><a href="struct__file.html#acad76db375ab79fd517b442cb7195cd8">_file::next_file</a></div><div class="ttdeci">struct _file * next_file</div><div class="ttdoc">A pointer on the next file.</div><div class="ttdef"><b>Definition:</b> structures.h:51</div></div>
<div class="ttc" id="astruct__file_html_ad9c747aeade1f77b30a4393a4be2a1be"><div class="ttname"><a href="struct__file.html#ad9c747aeade1f77b30a4393a4be2a1be">_file::name</a></div><div class="ttdeci">char name[NAME_MAX+1]</div><div class="ttdoc">The basename of the file.</div><div class="ttdef"><b>Definition:</b> structures.h:47</div></div>
<div class="ttc" id="astruct__file_html_af564d0d073559935815f33b08f7fbd51"><div class="ttname"><a href="struct__file.html#af564d0d073559935815f33b08f7fbd51">_file::file_size</a></div><div class="ttdeci">uint64_t file_size</div><div class="ttdoc">The isize of the file.</div><div class="ttdef"><b>Definition:</b> structures.h:49</div></div>
<div class="ttc" id="astructures_8h_html_a01f65533173671ccead98bc86ff8f004"><div class="ttname"><a href="structures_8h.html#a01f65533173671ccead98bc86ff8f004">s_directory</a></div><div class="ttdeci">struct _directory s_directory</div><div class="ttdoc">Structur to stock the content of a directory.</div></div>
<div class="ttc" id="astructures_8h_html_a07fb55fb8ca681eee25e1f632b6701ad"><div class="ttname"><a href="structures_8h.html#a07fb55fb8ca681eee25e1f632b6701ad">e_type</a></div><div class="ttdeci">e_type</div><div class="ttdoc">Enum to indicate what type has the file targeted.</div><div class="ttdef"><b>Definition:</b> structures.h:35</div></div>
<div class="ttc" id="astructures_8h_html_a07fb55fb8ca681eee25e1f632b6701ada00512007115c06f83e278302d7c70590"><div class="ttname"><a href="structures_8h.html#a07fb55fb8ca681eee25e1f632b6701ada00512007115c06f83e278302d7c70590">REGULAR_FILE</a></div><div class="ttdeci">@ REGULAR_FILE</div><div class="ttdoc">It is a regualr file.</div><div class="ttdef"><b>Definition:</b> structures.h:37</div></div>
<div class="ttc" id="astructures_8h_html_a07fb55fb8ca681eee25e1f632b6701ada9d09f58160b1161920aad19080f568cc"><div class="ttname"><a href="structures_8h.html#a07fb55fb8ca681eee25e1f632b6701ada9d09f58160b1161920aad19080f568cc">DIRECTORY</a></div><div class="ttdeci">@ DIRECTORY</div><div class="ttdoc">It is a directory.</div><div class="ttdef"><b>Definition:</b> structures.h:36</div></div>
<div class="ttc" id="astructures_8h_html_a07fb55fb8ca681eee25e1f632b6701adaabd2ef38f6c18626db708c01cc587429"><div class="ttname"><a href="structures_8h.html#a07fb55fb8ca681eee25e1f632b6701adaabd2ef38f6c18626db708c01cc587429">OTHER_TYPE</a></div><div class="ttdeci">@ OTHER_TYPE</div><div class="ttdoc">It has another type.</div><div class="ttdef"><b>Definition:</b> structures.h:38</div></div>
<div class="ttc" id="astructures_8h_html_ae959bb43b3e29fdc649ae621a6607247"><div class="ttname"><a href="structures_8h.html#ae959bb43b3e29fdc649ae621a6607247">s_file</a></div><div class="ttdeci">struct _file s_file</div><div class="ttdoc">Structure to stock the content of a file.</div></div>
</div><!-- fragment --><p>La structure <code>s_file</code> ne requiert pas de valeurs dans tous ses champs, en fonction du type réel du fichier considéré (fichier standard, ou fichier spécial incluant les liens symboliques).</p>
<h3><a class="anchor" id="autotoc_md6"></a>
sauvegarde dans un fichier</h3>
<p>Par défaut dans <code>~/.filescanner/yyyy-MM-dd-hh:mm:ss.scan</code>. Créer le dossier <code>~/.filescanner</code> si nécessaire.</p>
<p>Le fichier contient une ligne par entrée. Les informations sont stockées séparées par des tabulations (caractère &lsquo;&rsquo;\t'`).</p>
<p>Une ligne de répertoire se présente sous la forme suivante : <code>0 date chemin/</code> où :</p>
<ul>
<li><code>0</code> est la valeur pour le type DIRECTORY dans l'énumération <code>e_type</code>;</li>
<li><code>date</code> est la date de modification du répertoire;</li>
<li><code>chemin</code> est son chemin complet (il faut y penser quand vous parcourez la mémoire) terminé par un <code>/</code>. Les deux champs sont séparés par une tabulation.</li>
</ul>
<p>Une ligne de fichier standard se présente sous la forme <code>1 date taille MD5 chemin</code> où :</p>
<ul>
<li><code>1</code> est le code de <code>REGULAR_FILE</code>;</li>
<li><code>date</code> est la date comme définie pour le dossier;</li>
<li><code>taille</code> est la taille en octets du fichier;</li>
<li><code>MD5</code> est la somme MD5 du fichier en représentation hexadécimale;</li>
<li><code>chemin</code> est le chemin complet vers le fichier depuis la racine du scan. Pour les fichiers, il n'y a pas de <code>/</code> à la fin du chemin.</li>
</ul>
<p>Une ligne de fichier autre (lien, etc.) se présente sous la forme <code>2 date chemin</code> où <code>2</code> est le code de <code>OTHER_TYPE</code>, et <code>date</code> et <code>chemin</code> sont définis de la même manière que pour un fichier standard.</p>
<p>L'écriture dans le fichier doit être faite dans l'ordre suivant :</p>
<ul>
<li>le dossier en cours de traitement</li>
<li>ses fichiers</li>
<li>ses sous dossiers</li>
<li>puis on traite les contenus des sous dossiers</li>
</ul>
<h3><a class="anchor" id="autotoc_md7"></a>
Paramétrage du comportement</h3>
<p>Le comportement de l'application peut être paramétré suivant plusieurs options :</p>
<ul>
<li>L'option <b>-o</b> suivie d'un argument permet de spécifier le fichier dans lequel la sauvegarde de la liste de l'arborescence se fera.</li>
<li>L'option <b>-s</b> sans argument active le calcul des sommes MD5 des fichiers.</li>
<li>L'option <b>-i</b> suivie d'un argument spécifie le dossier à analyser.</li>
</ul>
<h2><a class="anchor" id="autotoc_md8"></a>
Décomposition du programme</h2>
<p>Le programme sera séparé en plusieurs fichiers de code, chacun ayant un rôle précis.</p>
<h3><a class="anchor" id="autotoc_md9"></a>
main</h3>
<p>Le fichier <code><a class="el" href="main_8c.html" title="The main function of our project. It is used to run the program and get options given by the user.">main.c</a></code> contiendra la fonction <code>main</code> qui aura deux rôles :</p>
<ul>
<li>Tester les options passées au programme pour son paramétrage, en utilisant getopt;</li>
<li>Appeler les fonctions des autres fichiers pour scanner le répertoire cible, construire la structure en mémoire, et l'écrire dans le fichier de scan.</li>
</ul>
<h3><a class="anchor" id="autotoc_md10"></a>
Scan</h3>
<p>Les fichiers <code><a class="el" href="scan_8h.html" title="The functions used to scan the file in a certain file system are here.">scan.h</a></code> et <code><a class="el" href="scan_8c.html" title="The functions used to scan the file in a certain file system are here.">scan.c</a></code> contiendront respectivement les signatures et les définitions des fonctions nécessaires au scan, notamment :</p>
<div class="fragment"><div class="line"><a class="code" href="struct__directory.html">s_directory</a> *<a class="code" href="scan_8c.html#ac6fd3e9c3cb7d20bf628a993f456dcd3">process_dir</a>(<span class="keywordtype">char</span> *path);</div>
<div class="line"><a class="code" href="struct__file.html">s_file</a> *<a class="code" href="scan_8c.html#aa17626a50f82025693b9a8801da44fed">process_file</a>(<span class="keywordtype">char</span> *path);</div>
<div class="ttc" id="ascan_8c_html_aa17626a50f82025693b9a8801da44fed"><div class="ttname"><a href="scan_8c.html#aa17626a50f82025693b9a8801da44fed">process_file</a></div><div class="ttdeci">s_file * process_file(char *path, bool md5)</div><div class="ttdoc">scan a file and put his content in a s_file strcture.</div><div class="ttdef"><b>Definition:</b> scan.c:65</div></div>
<div class="ttc" id="ascan_8c_html_ac6fd3e9c3cb7d20bf628a993f456dcd3"><div class="ttname"><a href="scan_8c.html#ac6fd3e9c3cb7d20bf628a993f456dcd3">process_dir</a></div><div class="ttdeci">s_directory * process_dir(char *path, bool md5)</div><div class="ttdoc">scan an entire directory and put the content of this directory in a s_directory structure.</div><div class="ttdef"><b>Definition:</b> scan.c:15</div></div>
</div><!-- fragment --><p> Ces fonctions traitent respectivement les dossiers (en lisant leur contenu) et les fichiers (en testant leur type et en calculant les informations nécessaires). Elles renvoient un pointeur vers une structure de dossier ou de fichier, NULL en cas de problème. Le pointeur renvoyé a pour but d'ajouter l'élément à la liste en mémoire. Il ne faut pas oublier de libérer tous ces pointeurs à la fin de l'exécution du programme. Ceci sera vérifié et participera à la note du projet.</p>
<h3><a class="anchor" id="autotoc_md11"></a>
Save</h3>
<p>Les fichiers <code><a class="el" href="save_8h.html" title="All the functions linked to the save in a file is here.">save.h</a></code> et <code><a class="el" href="save_8c.html" title="All the functions linked to the save in a file is here.">save.c</a></code> contiendront respectivement les signatures et les définitions des fonctions pour la sauvegarde de la structure en mémoire résultant du scan. <em>A minima</em>, on y trouvera :</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="save_8c.html#adf915bb21733f9369b0b0766fc194aa8">save_to_file</a>(<a class="code" href="struct__directory.html">s_directory</a> *root, <span class="keywordtype">char</span> *path_to_target);</div>
<div class="ttc" id="asave_8c_html_adf915bb21733f9369b0b0766fc194aa8"><div class="ttname"><a href="save_8c.html#adf915bb21733f9369b0b0766fc194aa8">save_to_file</a></div><div class="ttdeci">int save_to_file(s_directory *root, char *path_to_target, bool md5)</div><div class="ttdoc">Function to write the content of a s_directory (root).</div><div class="ttdef"><b>Definition:</b> save.c:15</div></div>
</div><!-- fragment --><p> Cette fonction écrira dans le fichier accessible par le chemin <code>path_to_target</code> l'ensemble des informations de la structure pointée par <code>root</code>. La fonction renvoie 0 en cas d'échec, -1 sinon. Il est fortement conseillé de créer des fonctions additionnelles pour traiter séparément l'écriture des différents types d'enregistrements.</p>
<h3><a class="anchor" id="autotoc_md12"></a>
Tree</h3>
<p>Les fichiers <code><a class="el" href="tree_8h.html" title="All the functions used to modify the s_directory &amp; s_file structure are here.">tree.h</a></code> et <code><a class="el" href="tree_8c.html" title="All the functions used to modify the s_directory &amp; s_file structure are here.">tree.c</a></code> contiendront les signatures et les définitions des fonctions pour manipuler l'arborescence sauvée en mémoire. Notamment, on y trouvera :</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="tree_8c.html#aa5a960c3f7fa398721c4c6bce5292798">append_subdir</a>(<a class="code" href="struct__directory.html">s_directory</a> *child, <a class="code" href="struct__directory.html">s_directory</a> *parent);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="tree_8c.html#ac5d7734bf46c8d1991cc73a2d84d1c7b">append_file</a>(<a class="code" href="struct__file.html">s_file</a> *child, <a class="code" href="struct__directory.html">s_directory</a> *parent);</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="tree_8c.html#aba17d5ab64c3063d802020bd4dc288ec">clear_files</a>(<a class="code" href="struct__directory.html">s_directory</a> *parent);</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="tree_8c.html#a57e89494bf2cd866513e011780dc261c">clear_subdirs</a>(<a class="code" href="struct__directory.html">s_directory</a> *parent);</div>
<div class="ttc" id="atree_8c_html_a57e89494bf2cd866513e011780dc261c"><div class="ttname"><a href="tree_8c.html#a57e89494bf2cd866513e011780dc261c">clear_subdirs</a></div><div class="ttdeci">void clear_subdirs(s_directory *parent)</div><div class="ttdoc">clean recursively the entire content of the parent directory.</div><div class="ttdef"><b>Definition:</b> tree.c:48</div></div>
<div class="ttc" id="atree_8c_html_aa5a960c3f7fa398721c4c6bce5292798"><div class="ttname"><a href="tree_8c.html#aa5a960c3f7fa398721c4c6bce5292798">append_subdir</a></div><div class="ttdeci">int append_subdir(s_directory *child, s_directory *parent)</div><div class="ttdoc">insert a new directory on front of the &quot;parent&quot; list.</div><div class="ttdef"><b>Definition:</b> tree.c:15</div></div>
<div class="ttc" id="atree_8c_html_aba17d5ab64c3063d802020bd4dc288ec"><div class="ttname"><a href="tree_8c.html#aba17d5ab64c3063d802020bd4dc288ec">clear_files</a></div><div class="ttdeci">void clear_files(s_directory *parent)</div><div class="ttdoc">clear the list of files contained in the parent directory.</div><div class="ttdef"><b>Definition:</b> tree.c:37</div></div>
<div class="ttc" id="atree_8c_html_ac5d7734bf46c8d1991cc73a2d84d1c7b"><div class="ttname"><a href="tree_8c.html#ac5d7734bf46c8d1991cc73a2d84d1c7b">append_file</a></div><div class="ttdeci">int append_file(s_file *child, s_directory *parent)</div><div class="ttdoc">insert a new file on front of the files' linked list contained in the parent directory.</div><div class="ttdef"><b>Definition:</b> tree.c:26</div></div>
</div><!-- fragment --><p>Les fonctions <code>append_subdir</code> et <code>append_file</code> vont respectivement ajouter un sous-répertoire ou un fichier pointés par <code>child</code> à la liste des sous répertoires ou des fichiers du noeud pointé par <code>parent</code></p>
<p>Les fonctions <code>clear_files</code> et <code>clear_subdirs</code> vont respectivement libérer la mémoire des listes des fichiers et des sous répertoires du noeud pointé par <code>parent</code>.</p>
<p>Attention ! La fonction <code>clear_subdirs</code> doit d'abord libérer récursivement le contenu des sous-répertoires avant de pouvoir les libérer.</p>
<h3><a class="anchor" id="autotoc_md13"></a>
MD5</h3>
<p>Les fichiers <code><a class="el" href="md5sum_8h.html" title="The functions used to compute the md5sum are here.">md5sum.h</a></code> et <code><a class="el" href="md5sum_8c.html" title="The functions used to compute the md5sum are here.">md5sum.c</a></code> contiendront respectivement les signatures et les définitions des fonctions relatives au calcul de la somme MD5 d'un fichier, notamment la fonction suivante :</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="md5sum_8c.html#a68b18b4c28047534e58f18fd86bcc3de">compute_md5</a>(<span class="keywordtype">char</span> *path, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buffer[]);</div>
<div class="ttc" id="amd5sum_8c_html_a68b18b4c28047534e58f18fd86bcc3de"><div class="ttname"><a href="md5sum_8c.html#a68b18b4c28047534e58f18fd86bcc3de">compute_md5</a></div><div class="ttdeci">int compute_md5(char *path, unsigned char buffer[])</div><div class="ttdoc">Function to compute the md5 sum of file. If the file is not accessible or if it is not a classic file...</div><div class="ttdef"><b>Definition:</b> md5sum.c:14</div></div>
</div><!-- fragment --><p> Cette fonction calcule la somme MD5 du fichier accessible par le chemin <code>path</code>, et en stocke la valeur dans le tableau de caractères non signés <code>buffer</code>.</p>
<p>Vous pouvez utiliser d'autres fonctions appelées par celle-ci pour faciliter votre développement.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
Méthode de travail</h2>
<p>Afin de limiter vos conflits de code (i.e. des modifications incompatibles sur des fichiers), il est conseillé que vous vous répartissiez les tâches sur des fonctionnalités différentes, en changeant périodiquement de rôle afin de permettre à chacun de s'approprier les notions et la technique relative à l'ensemble du projet.</p>
<p>Il vous sera également nécessaire de planifier des synchronisations <b>au minimum toutes les deux semaines, de préférence chaque semaine</b>. Ces points d'avancement feront l'objet de compte rendus qui seront à inclure au rapport du projet.</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Bonus</h2>
<p>Quelques points de bonus sont réservés aux groupes dont la sauvegarde dans un fichier se fera, non plus en mode texte, mais dans une base de données SQLite. Vous pouvez consulter la <a href="https://www.sqlite.org/cintro.html">documentation de l'API SQLite pour C/C++</a> pour plus d'informations.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Rendu</h2>
<p>Le document principal à remettre est le code du projet, sur git-info, accompagné du Makefile permettant sa compilation, et d'un README.md qui décrit les éventuelles bibliothèques à installer, ainsi que l'utilisation de l'application.</p>
<p>Par ailleurs, un rapport succinct sera à remettre, en deux temps : à mi-projet (date à définir), les choix arrêtés par le groupe devront être définis et justifiés (choix ou non de l'intégration de SQLite, ajout de fonctions dans les différents modules du programme, etc.).</p>
<p>Ce rapport sera ensuite enrichi du RETEX du projet une fois celui-ci terminé. Pour réaliser ce RETEX, vous prendrez à tour de rôle la direction de la rédaction d'un "compte rendu de mission", dans lequel vous interrogerez vos camarades de projet sur les points qui vous paraissent nécessiter une amélioration et/ou un éclaircissement, ainsi que sur la question suivante : _"En se basant sur le déroulement du projet, aujourd'hui que ferais-tu différemment ?"_. Les compte rendus de tous les membres du groupes devront ensuite être synthétisés en RETEX et ajoutés au rapport pour produire le document final à rendre en fin de semestre.</p>
<p>Il vous sera probablement également demandé de présenter ce rapport et le projet dans un exposé oral, soit en face à face, soit en visioconférence.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
Annexes</h2>
<p>Dans ces annexes, quelques informations vous sont données sur l'utilisation des API non vues en cours, TD ou TP.</p>
<h3><a class="anchor" id="autotoc_md18"></a>
MD5</h3>
<p>La bibliothèque pour calculer des sommes MD5 est fournie avec OpenSSL. Pour l'utiliser, il faut inclure <code>openssl/MD5.h</code> dans votre fichier source. Puis, vous devez lier la bibliothèque dynamique libcrypto à votre programme (option <code>-lcrypto</code> à l'édition des liens)</p>
<p>Il est nécessaire d'ouvrir le fichier dont vous calculez la somme MD5 et de le lire par parties (à vous de choisir la taille des éléments que vous traitez) afin de permettre à MD5 de calculer la somme sur la taille complète du fichier.</p>
<p>Quelques informations supplémentaires au sujet de MD5 vous seront données ultérieurement.</p>
<h1><a class="anchor" id="autotoc_md19"></a>
Réalisation par notre groupe</h1>
<p>Nous avons réalisé tous les objectifs demandés mis à part l'objectif optionnel consistant à écrire nos fichiers dans une base de donnée sqlite.</p>
<h2><a class="anchor" id="autotoc_md20"></a>
Fonctionnement du makefile</h2>
<p>Le make file est doté de plusieurs phony targets afin de simplifier son utilisation :</p>
<ul>
<li>clean : Permet de nettoyer les répertoires contenant les fichiers .o et les fichiers binaires.</li>
<li>run : Permet de faire directement tourner le programme avec les options par défaut.</li>
<li>run_md5 : Permet de faire tourner le programme en calculant les sommes md5 mais avec les autres options par défaut.</li>
<li>debug : Permet de lancer le débugage avec gdb directement après la compilation.</li>
<li>help : Permet d'afficher le message d'help inspiré des pages de manuel linux.</li>
<li>all : (par défaut) Permet de compiler l'ensemble des fichiers.</li>
</ul>
<h2><a class="anchor" id="autotoc_md21"></a>
Aide</h2>
<p>Nous avons réalisé une aide afin de rendre l'utilisation du programme plus claire pour l'utilisateur. Cette aide est la suivante :</p>
<div class="fragment"><div class="line">NOM :</div>
<div class="line">    arborescence_displayer [OPTIONS]</div>
<div class="line">DESCRIPTION :</div>
<div class="line">    This programm will let you display the file arborescence of any directory of your file system.</div>
<div class="line"> </div>
<div class="line">OPTIONS : </div>
<div class="line">    -o, --save-file [file_name] :</div>
<div class="line">        The file where the arborescence&#39;s informations will be displayed. If you want to put the informations in the commandline, just write &#39;stdout&#39;</div>
<div class="line">        By default the datas are saved in ~/.filescanner/yyyy-MM-dd-hh:mm:ss.scan file.</div>
<div class="line"> </div>
<div class="line">    -i, --directory [dir_name] :</div>
<div class="line">        The directory to scan. By default, the directory scanned will the current directory.</div>
<div class="line"> </div>
<div class="line">    -s, --evaluate_md5 :</div>
<div class="line">        The md5sum will be calculated when it is possible.</div>
<div class="line"> </div>
<div class="line">    -h, --help :</div>
<div class="line">        Display this help message.</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
